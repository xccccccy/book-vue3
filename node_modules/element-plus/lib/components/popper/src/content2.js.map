{"version":3,"file":"content2.js","sources":["../../../../../../packages/components/popper/src/content.vue"],"sourcesContent":["<template>\n  <div\n    ref=\"popperContentRef\"\n    :style=\"contentStyle\"\n    :class=\"contentClass\"\n    role=\"tooltip\"\n    @mouseenter=\"(e) => $emit('mouseenter', e)\"\n    @mouseleave=\"(e) => $emit('mouseleave', e)\"\n  >\n    <slot />\n  </div>\n</template>\n\n<script lang=\"ts\" setup>\nimport { computed, inject, onMounted, provide, ref, unref, watch } from 'vue'\nimport { createPopper } from '@popperjs/core'\nimport { useNamespace, useZIndex } from '@element-plus/hooks'\nimport {\n  POPPER_CONTENT_INJECTION_KEY,\n  POPPER_INJECTION_KEY,\n} from '@element-plus/tokens'\nimport { usePopperContentProps } from './content'\nimport { buildPopperOptions, unwrapMeasurableEl } from './utils'\n\nimport type { WatchStopHandle } from 'vue'\n\ndefineOptions({\n  name: 'ElPopperContent',\n})\n\ndefineEmits(['mouseenter', 'mouseleave'])\n\nconst props = defineProps(usePopperContentProps)\n\nconst { popperInstanceRef, contentRef, triggerRef } = inject(\n  POPPER_INJECTION_KEY,\n  undefined\n)!\nconst { nextZIndex } = useZIndex()\nconst ns = useNamespace('popper')\nconst popperContentRef = ref<HTMLElement>()\nconst arrowRef = ref<HTMLElement>()\nconst arrowOffset = ref<number>()\nprovide(POPPER_CONTENT_INJECTION_KEY, {\n  arrowRef,\n  arrowOffset,\n})\nconst contentZIndex = ref(props.zIndex || nextZIndex())\n\nconst computedReference = computed(\n  () => unwrapMeasurableEl(props.referenceEl) || unref(triggerRef)\n)\n\nconst contentStyle = computed(\n  () => [{ zIndex: unref(contentZIndex) }, props.popperStyle] as any\n)\n\nconst contentClass = computed(() => [\n  ns.b(),\n  ns.is('pure', props.pure),\n  ns.is(props.effect),\n  props.popperClass,\n])\n\nconst createPopperInstance = ({ referenceEl, popperContentEl, arrowEl }) => {\n  const options = buildPopperOptions(props, {\n    arrowEl,\n    arrowOffset: unref(arrowOffset),\n  })\n\n  return createPopper(referenceEl, popperContentEl, options)\n}\n\nconst updatePopper = () => {\n  unref(popperInstanceRef)?.update()\n  contentZIndex.value = props.zIndex || nextZIndex()\n}\n\nconst togglePopperAlive = () => {\n  const monitorable = { name: 'eventListeners', enabled: props.visible }\n  unref(popperInstanceRef)?.setOptions?.((options) => ({\n    ...options,\n    modifiers: [...(options.modifiers || []), monitorable],\n  }))\n  updatePopper()\n}\n\nonMounted(() => {\n  let updateHandle: WatchStopHandle\n  watch(\n    computedReference,\n    (referenceEl) => {\n      updateHandle?.()\n      const popperInstance = unref(popperInstanceRef)\n      popperInstance?.destroy?.()\n      if (referenceEl) {\n        const popperContentEl = unref(popperContentRef)!\n        contentRef.value = popperContentEl\n\n        popperInstanceRef.value = createPopperInstance({\n          referenceEl,\n          popperContentEl,\n          arrowEl: unref(arrowRef),\n        })\n\n        updateHandle = watch(\n          () => referenceEl.getBoundingClientRect(),\n          () => updatePopper(),\n          {\n            immediate: true,\n          }\n        )\n      } else {\n        popperInstanceRef.value = undefined\n      }\n    },\n    {\n      immediate: true,\n    }\n  )\n\n  watch(() => props.visible, togglePopperAlive, { immediate: true })\n\n  watch(\n    () =>\n      buildPopperOptions(props, {\n        arrowEl: unref(arrowRef),\n        arrowOffset: unref(arrowOffset),\n      }),\n    (option) => popperInstanceRef.value?.setOptions(option)\n  )\n})\n\ndefineExpose({\n  /**\n   * @description popper content element\n   */\n  popperContentRef,\n  /**\n   * @description popperjs instance\n   */\n  popperInstanceRef,\n  /**\n   * @description method for updating popper\n   */\n  updatePopper,\n\n  /**\n   * @description content style\n   */\n  contentStyle,\n})\n</script>\n"],"names":["inject","POPPER_INJECTION_KEY","useZIndex","useNamespace","ref","provide","POPPER_CONTENT_INJECTION_KEY","computed","unwrapMeasurableEl","unref","buildPopperOptions","createPopper","onMounted","watch"],"mappings":"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"}